(this["webpackJsonpaviasales-test-assignment"]=this["webpackJsonpaviasales-test-assignment"]||[]).push([[0],{13:function(t,e,s){},15:function(t,e,s){},16:function(t,e,s){"use strict";s.r(e);var n=s(1),a=s.n(n),r=s(8),i=s.n(r),c=(s(13),s(2)),o=s(3),u=s(6),l=s(5),h=s(4),f=s(0),_=function(t){Object(l.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t))._items=n.props.items,n._searchValues=[-1],n.changed=n.props.onChange,n}return Object(o.a)(s,[{key:"_checkState",value:function(){var t=[];document.querySelector(".transfers").querySelectorAll(".transfers__checkbox").forEach((function(e){e.checked&&t.push(+e.value)})),this._searchValues=t,this.changed(this._searchValues)}},{key:"_changeHandler",value:function(t){var e=t.target.parentNode.attributes.data.value,s=t.target.checked;-1===+e&&!0===s&&this._swtichOffFilteres(),-1!==+e&&!0===s&&this._swtichOffAllFilter(),this._checkState()}},{key:"_swtichOffAllFilter",value:function(){document.querySelector(".transfers").querySelector("#transfer-all").checked=!1}},{key:"_swtichOffFilteres",value:function(){document.querySelector(".transfers").querySelectorAll(".transfers__checkbox").forEach((function(t){"transfer-all"!==t.id&&(t.checked=!1)}))}},{key:"_getCheckboxItems",value:function(){return this._items.map((function(t){return Object(f.jsxs)("label",{className:"transfers__item",htmlFor:t.name,data:t.value,children:[Object(f.jsx)("input",{type:"checkbox",name:t.name,id:t.name,className:"transfers__checkbox",defaultChecked:t.checked,value:t.value}),Object(f.jsx)("p",{className:"transfers__checkbox-caption",children:t.caption})]},t.name)}))}},{key:"render",value:function(){var t=this;return Object(f.jsxs)("fieldset",{className:"transfers",onChange:function(e){t._changeHandler(e)},children:[Object(f.jsx)("label",{className:"transfers__caption",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),this._getCheckboxItems()]})}}]),s}(a.a.Component),d=[{name:"transfer-all",caption:"\u0412\u0441\u0435",value:"-1",checked:!0},{name:"transfer-no-transfers",caption:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",value:"0",checked:!1},{name:"transfer-1",caption:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",value:"1",checked:!1},{name:"transfer-2",caption:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",value:"2",checked:!1},{name:"transfer-3",caption:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",value:"3",checked:!1}],p=[{name:"cheapest",caption:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439",checked:!0},{name:"fastest",caption:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439",checked:!1},{name:"optimal",caption:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439",checked:!1}],m=function(t){Object(l.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t))._items=n.props.items,n._sortOption="cheapest",n.changed=n.props.onChange,n}return Object(o.a)(s,[{key:"_getOptions",value:function(){var t=this;return this._items.map((function(e){return Object(f.jsxs)("div",{className:"sort-options__item",children:[Object(f.jsx)("input",{id:e.name,type:"radio",name:"sort-option",value:e.name,defaultChecked:e.checked,onInput:function(e){t._changeHandler(e)}}),Object(f.jsx)("label",{htmlFor:e.name,children:e.caption})]},e.name)}))}},{key:"_changeHandler",value:function(t){this._sortOption=t.target.value,this.changed(this._sortOption)}},{key:"render",value:function(){return Object(f.jsx)("div",{className:"sort-options",children:this._getOptions()})}}]),s}(a.a.Component),k=function(){function t(e){Object(c.a)(this,t),this._url=e}return Object(o.a)(t,[{key:"_loadJson",value:function(){return fetch(this._url).then((function(t){return t.json()})).then((function(t){return t}),(function(t){return t}))}},{key:"getData",value:function(){return this._loadJson()}},{key:"requestNewData",value:function(t){return this._url=t,this._loadJson()}}]),t}(),j=function(){function t(e,s){Object(c.a)(this,t),this._searchIdUrl=e[0],this._searchTicketsUrl=e[1],this.returnData=s}return Object(o.a)(t,[{key:"requestData",value:function(){var t=this,e=new k(this._searchIdUrl);e.getData().then((function(s){e.requestNewData(t._searchTicketsUrl+s.searchId).then((function(e){e.tickets?t.returnData(e):setTimeout((function(){return t.requestData()}),1e3)}))}))}}]),t}(),v=function(t){Object(l.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t))._price=n.props.ticket.price,n._carrier=n.props.ticket.carrier,n._startFrom=n.props.ticket.segments[0].origin,n._startTo=n.props.ticket.segments[0].destination,n._startDate=n.props.ticket.segments[0].date,n._startStops=n.props.ticket.segments[0].stops,n._startDuaration=n.props.ticket.segments[0].duration,n._finishFrom=n.props.ticket.segments[1].origin,n._finishTo=n.props.ticket.segments[1].destination,n._finishDate=n.props.ticket.segments[1].date,n._finishStops=n.props.ticket.segments[1].stops,n._finishDuaration=n.props.ticket.segments[1].duration,n}return Object(o.a)(s,[{key:"_getCarrierLogo",value:function(){return"//pics.avs.io/99/36/".concat(this._carrier,".png")}},{key:"_getDate",value:function(t,e){var s={hour:"numeric",minute:"numeric",hour12:!1},n=new Date(t),a=n.toLocaleString("ru",s);n.setMinutes(n.getMinutes()+e);var r=n.toLocaleString("ru",s);return"".concat(a," - ").concat(r)}},{key:"_getStopsString",value:function(t){return t.join(", ")}},{key:"_getPrice",value:function(){var t=this._price+"";return t.substr(0,2)+" "+t.substr(2)}},{key:"_getDaration",value:function(t){var e=parseInt(t/60),s=t%60;return"".concat(e,"\u0447 ").concat(s,"\u043c")}},{key:"_getTransfersText",value:function(t){var e=t.length;switch(e){case 1:return"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430";case 2:case 3:case 4:return"".concat(e," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438");default:return"".concat(e," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a")}}},{key:"render",value:function(){return Object(f.jsxs)("div",{className:"card",children:[Object(f.jsxs)("div",{className:"card__main-info",children:[Object(f.jsxs)("span",{className:"card__price",children:[this._getPrice()," \u0420"]}),Object(f.jsx)("img",{className:"card__company",alt:this._carrier,src:this._getCarrierLogo()})]}),Object(f.jsxs)("div",{className:"card__flight-info",children:[Object(f.jsxs)("div",{className:"info info_type_to",children:[Object(f.jsxs)("span",{className:"info__title",children:[this._startFrom," - ",this._startTo]}),Object(f.jsx)("span",{className:"info__value",children:this._getDate(this._startDate,this._startDuaration)})]}),Object(f.jsxs)("div",{className:"info info_type_time-to",children:[Object(f.jsx)("span",{className:"info__title",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(f.jsx)("span",{className:"info__value",children:this._getDaration(this._startDuaration)})]}),Object(f.jsxs)("div",{className:"info info_type_transfers-to",children:[Object(f.jsx)("span",{className:"info__title",children:this._getTransfersText(this._startStops)}),Object(f.jsx)("span",{className:"info__value",children:this._getStopsString(this._startStops)})]}),Object(f.jsxs)("div",{className:"info info_type_from",children:[Object(f.jsxs)("span",{className:"info__title",children:[this._finishFrom," - ",this._finishTo]}),Object(f.jsx)("span",{className:"info__value",children:this._getDate(this._finishDate,this._finishDuaration)})]}),Object(f.jsxs)("div",{className:"info info_type_time-to",children:[Object(f.jsx)("span",{className:"info__title",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(f.jsx)("span",{className:"info__value",children:this._getDaration(this._finishDuaration)})]}),Object(f.jsxs)("div",{className:"info info_type_transfers-to",children:[Object(f.jsx)("span",{className:"info__title",children:this._getTransfersText(this._finishStops)}),Object(f.jsx)("span",{className:"info__value",children:this._getStopsString(this._finishStops)})]})]})]})}}]),s}(a.a.Component),b=function(t){Object(l.a)(s,t);var e=Object(h.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).transfersSort=n.transfersSort.bind(Object(u.a)(n)),n.ticketsSort=n.ticketsSort.bind(Object(u.a)(n)),n.getData=n.getData.bind(Object(u.a)(n)),n._serverUrl=n.props.url,n.state={sortedTickets:{},renderedTickets:4},n._sortTicketsVal="cheapest",n._sortTransfersVal=[-1],n}return Object(o.a)(s,[{key:"transfersSort",value:function(t){this._sortTransfersVal=t.slice(),this._sortTickets()}},{key:"ticketsSort",value:function(t){this._sortTicketsVal=t,this._sortTickets()}},{key:"_resendData",value:function(){this.setState({sortedTickets:{}}),new j(this._serverUrl,this.getData).requestData()}},{key:"getData",value:function(t){this._originalTicketsData=t,this._originalTicketsData.tickets.forEach((function(t,e){t.key="ticket"+e})),this.setState({sortedTickets:this._originalTicketsData.tickets}),this._sortTickets()}},{key:"_clearTickets",value:function(){document.querySelectorAll(".card").forEach((function(t){return t.remove()}))}},{key:"_sortTickets",value:function(){var t,e=this;switch(this.setState({renderedTickets:4}),t=this._sortTransfersVal.includes(-1)?this._originalTicketsData.tickets.slice()||[]:this._originalTicketsData.tickets.filter((function(t){var s=t.segments[0].stops.length,n=t.segments[1].stops.length;return e._sortTransfersVal.includes(s)||e._sortTransfersVal.includes(n)})),this._sortTicketsVal){case"cheapest":this._sortByPrice(t);break;case"fastest":this._sortByTime(t);break;case"optimal":this._sortByOptimal(t);break;default:this._sortByPrice(t)}}},{key:"_sortByTime",value:function(t){var e=t.sort((function(t,e){return t.segments[0].duration+t.segments[1].duration-(e.segments[0].duration+e.segments[1].duration)}));this.setState({sortedTickets:e})}},{key:"_sortByPrice",value:function(t){var e=t.sort((function(t,e){return t.price-e.price}));this.setState({sortedTickets:e})}},{key:"_sortByOptimal",value:function(t){var e=t.sort((function(t,e){var s=t.segments[0].duration+t.segments[1].duration,n=e.segments[0].duration+e.segments[1].duration;return t.price+1*s-e.price+1*n}));this.setState({sortedTickets:e})}},{key:"_renderTickets",value:function(t,e){return this.state.sortedTickets.filter((function(s,n){return n>=t&&n<=e})).map((function(t,e){return Object(f.jsx)(v,{ticket:t},t.key)}))}},{key:"componentDidMount",value:function(){new j(this._serverUrl,this.getData).requestData()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var t=this;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("header",{className:"header",children:Object(f.jsx)("button",{type:"submit",className:"button-reset",onClick:function(){return t._resendData()}})}),Object(f.jsxs)("main",{className:"content",children:[Object(f.jsx)(_,{items:d,onChange:this.transfersSort}),Object(f.jsx)(m,{items:p,onChange:this.ticketsSort}),this.state.sortedTickets.length>0&&this._renderTickets(0,this.state.renderedTickets)||Object(f.jsx)("div",{className:"loader"}),Object(f.jsx)("button",{type:"button",className:"show-more-button",onClick:function(){return t.setState({renderedTickets:t.state.renderedTickets+5})},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0435 \u043f\u044f\u0442\u044c \u0431\u0438\u043b\u0435\u0442\u043e\u0432!"})]})]})}}]),s}(a.a.Component);s(15);var g=function(){return Object(f.jsx)("div",{className:"app",children:Object(f.jsx)(b,{url:["https://front-test.beta.aviasales.ru/search","https://front-test.beta.aviasales.ru/tickets?searchId="]})})},O=function(t){t&&t instanceof Function&&s.e(3).then(s.bind(null,17)).then((function(e){var s=e.getCLS,n=e.getFID,a=e.getFCP,r=e.getLCP,i=e.getTTFB;s(t),n(t),a(t),r(t),i(t)}))};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(g,{})}),document.getElementById("root")),O()}},[[16,1,2]]]);
//# sourceMappingURL=main.30d1c460.chunk.js.map